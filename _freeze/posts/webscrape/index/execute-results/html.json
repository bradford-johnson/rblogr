{
  "hash": "0985832911c408601bffe965c82a6f25",
  "result": {
    "markdown": "---\ntitle: \"Web Scraping with `rvest`\"\nauthor: \"Bradford Johnson\"\ndate: \"2022-09-18\"\nimage: \"josh-berendes-2zcemW2Oy8Y-unsplash.jpg\"\ncategories: [web scraping, rvest]\n---\n\n\n## **How to Web Scrape with `rvest`**\n\nUsing the `rvest` package you can get the data you need from webpages and quickly use it for analysis.\n\nBelow I will show a simple script using the `rvest`, `lubridate` and `tidyverse` packages that can scrape us some data from [Steam's](https://store.steampowered.com/stats/) game stats page. Steam is a video game distribution service, and we will scrape a couple columns from their live *Top games by current player count* table.\n\nFirst of course install and load the packages, if you already have any of these packages then you just need to load them.\n\n## Install and Load Packages\n\n``` r\ninstall.packages(\"tidyverse\")\ninstall.packages(\"rvest\")\ninstall.packages(\"lubridate\")\n\nlibrary(tidyverse)\nlibrary(rvest)\nlibrary(lubridate)\n```\n\n\n\n\n\nIf you want to see the documentation for any of these packages then click their hex image.\n\n[![rvest](https://github.com/rstudio/hex-stickers/blob/master/thumbs/rvest.png?raw=true)](https://rvest.tidyverse.org/) [![tidyverse](https://github.com/rstudio/hex-stickers/blob/master/thumbs/tidyverse.png?raw=true)](https://tidyverse.tidyverse.org/) [![lub](https://github.com/rstudio/hex-stickers/blob/master/thumbs/lubridate.png?raw=true)](https://lubridate.tidyverse.org/)\n\n## Setting the Parameters\n\nNext you will set up the parameters so `rvest` knows where to get the data from. The `html_nodes` can be found using the browser extension `SelectorGadget` found [here](https://chrome.google.com/webstore/detail/selectorgadget/mhjhnkcfbdhnjickkkdbjoemdmbfginb). Using this extension you can highlight what you want to web scrape and copy/paste the html nodes from `SelectorGadget`.\n\n``` r\n# link to get data from\nlink = \"https://store.steampowered.com/stats/\" \n# read webpage at the above link\npage = read_html(link) \n# scrape top 100 games by current players\ngame = page %>% \n  html_nodes(\".gameLink\") %>% \n  html_text()  \n# scrape number of players for each game \ncurrent_players = page %>% \n  html_nodes(\"td:nth-child(1) .currentServers\") %>% \n  html_text() \n```\n\n\n\n\n\n## Creating the Data Frame\n\nAfter getting all the data you will want to put it into a data frame to work with it, so you will then use the `data.frame()` function and add in the data you pulled from online. Below you will see how I am creating the data frame and adding in the current date as a column so I know when I collected this data.\n\n``` r\n# put both game and player data into a data frame\ndf = data.frame(game, current_players) \n# get current date\ncurrent_date <- as_datetime(Sys.Date())\n# update data frame with mutated column that adds current_date\ndf <- df %>% \n  mutate(date = current_date)\n```\n\n\n\n\n\nNow lets see the first 6 rows of our new data frame that we crafted using `rvest`.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nhead(df)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] game            current_players date           \n<0 rows> (or 0-length row.names)\n```\n:::\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}